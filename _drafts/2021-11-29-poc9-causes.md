---
title: 'Pearls of Causality #9: Potential, Genuine, Temporal Causes and Spurious Association'
date: 2021-11-29
permalink: /posts/2021/11/2021-11-29-poc9-causes
tags:
  - causality
  - DAG
  - latents
  - Pearl
  - spuriousity
  - cause
---

Hitting the nail on its arrowhead, a.k.a. when does $X$ cause $Y$?

### PoC Post Series
- [PoC #8: Inferred Causation, $IC$, and ${IC}^*$](/posts/2021/11/poc8-ic-ic-ic)
- ➡️ [PoC #9: Potential, Genuine, Temporal Causes and Spurious Association](/posts/2021/11/poc9-causes/)

# Time-agnostic Relationships
$IC^*$ results in a PDAG with four edge types, as discussed in [PoC #8](/posts/2021/11/poc8-ic-ic-ic). We can think about those as expressing our "certainty" whether a relationship is causal:

1. $a\rightarrow^{*} b$: $a$ causes $b$
2. $a\rightarrow b$:  $a$ _potentially_ causes $b$
3. $a \leftrightarrow b$: $a$ and $b$ are _spuriously associated_
4. $a-b:$ we have no clue whether the relationship is causal or spurious (the direction is also unknown)

In the following, **adjacency** is used to emphasize that there is an edge between $a$ and $b$; whereas a **context** $S$ means a set of variable assignments (only w.r.t. the observed variables - latent values cannot be assigned as they are unobservable). Context-specific independence $(\perp_c)$ is a shorthand for $X \perp Y \| Z, C=c$.

## Potential Cause
>$X$ is a **potential cause** of $Y$ (that is inferable from $P$) if:
>1. $X$ and $Y$ are dependent in every context ($X \not\perp_c Y$).
>2. There exists a variable $Z$ and a context $S:$ 
>    1. $X \perp Z \| S$
>    2. $Y \not\perp Z \| S$

The definition of potential cause excludes $X\leftarrow Y$; thus leaving only the options:
- $X \rightarrow Y$
- $X \leftrightarrow Y$

Namely, if  $X\leftarrow Y$ would be possible, then that would mean that  $X \not\perp Z \| S$ - as there is an edge, and so an active path, between $Y$ and $X$. Succintly, $Z \not\perp Y\|S$ and  $X \not\perp Y \| S$ imply  $X \perp Z \| S$ for the active paths between $Z-\dots-Y$ and $Y-\dots-X$ can be joined together.

> If $X$ is a potential cause of $Y$, then $X$ either causes $Y$ or they have the same parent.


## Genuine Cause
>$X$ is the **genuine cause** of $Y$ if there exists a variable $Z$ such that either:
>1. $X$ and $Y$ are dependent in any context ($X \not\perp_c Y $) and $\exists$ context $S$:
>    1. $Z$ is a potential cause of $X$
>    2. $Y \not\perp Z \| S$
>    3. $Y \perp Z \| S \cup X$
>2. $X$ and $Y$ are in a [transitive closure](https://en.wikipedia.org/wiki/Transitive_closure) of criterion 1.

Our ultimate goal is to identify genuine causes, which use the potential cause definition as a stepping stone. The trick here is that when reasoning about the causal relationship of $X$ and $Y$, a third variable $Z$ will be used as a potential cause.

By requiring $Z$ to be the potential cause of $X$, we imply 
- $Z \rightarrow X$
- $Z \leftrightarrow X$

Conditions 2 and 3 will rule out $X \leftarrow Y$ and $X \leftrightarrow Y$ (context-specific dependence means there is an $X-Y$ edge), as they require that the effect of $Z$ on $Y$ is mediated by $X$ (otherwise, conditioning on $X$ could not block the path). Thus, the latent common cause scenario $X \leftrightarrow Y$ is infeasible.

The mention of the transitive closure means that $X$ is also a genuine cause of $Y$ if $X$ is a genuine cause of $W$ and $W$ is a genuine cause of $Y$. 

## Spurious Association
>$X$ and $Y$ are **spuriously associated** if $\exists$ variables $ Z_1, Z_2$ and contexts $S_1, S_2$:
>1. $X \not\perp Z_1 \| S_1$
>2. $Y \perp Z_1 \| S_1$
>3. $Y \not\perp Z_2 \| S_2$
>4. $X \perp Z_2 \| S_2$

When parsing The definition of spurious associations, we can think of applying condition 2 (with its two requirements) of potential causes twice. $X \not\perp Z_1 \| S_1$ and $Y \perp Z_1 \| S_1$ rule out $X\leftarrow Y$, while $Y \not\perp Z_2 \| S_2$ and $X \perp Z_2 \| S_2$ exclude $X\rightarrow Y$. So the only remaining option is $X \leftrightarrow Y$, meaning that there is no causal influence between $X$ and $Y$.

# Time-dependent Relationships

- adjacent and preceding variables are potential casues
- adjacency not required if context precedes X

When we have temporal information (such as sensor measurements), the above definitions simplify. Intuitively, $X$ can only be a cause of $Y$ is $X$ precedes $Y$.

## Potential Causation with Temporal Information
> $X$ is a **potential cause** of $Y$ if:
> 1. $X$ precedes $Y$
> 2. $X$ and $Y$ are dependent in every context ($X \not\perp_c Y$).


The temporal information is used to exclude $X\leftarrow Y$. This agrees with our everyday intuition and makes causal inference simpler as there is no need for conditional independence tests with a third variable $Z$. The second condition requires the adjacency of $X$ and $Y$ (a latent common cause is still possible). 


An alternative option to context-specific dependence that we will use for temporal genuine causes is requiring that
> Context $S$ precedes $X$, 

meaning that $S$ is not in the path $X-\dots-Y$; thus, it is not the reason why $Z$ is dependent on $Y$ but not on $X$. Note that **temporal precedence is still required**.


## Genuine Causation with Temporal Information
>$X$ is a **genuine cause** of $Y$ if there exists a variable $Z$ and a context $S$, both occurring before $X$, such that:
>1. $X$ precedes $Y$
>2. $Y \not\perp Z | S$
>3. $Y \perp Z | S\cup X$


In this definition, temporal precedence requires $Z$ and $S$ preceding $X$ preceding $Y$ - so these are the only possible causal directions-, the two remaining conditions are the same as in the non-temporal definition. Note that the context-specific dependence of $X$ and $Y$ is not required - equivalently, we do not postulate in advance the existence of an $X-Y$ edge. 

This relationship is implied by the second and third conditions (as they exclude both $Z$ and $S$ as a cause of $Y$).



## Spurious Association with Temporal Information
>$X$ and $Y$ are **spuriously associated** if $\exists S : X \not\perp Y \|S$ and $\exists Z$ such that:
>1. $X$ precedes $Y$ 
>2. $Y \perp Z \| S$
>3. $X \not\perp Z \| S$

- no genuine cause as that would require dependent Z and Y

In this case, condition one excludes $Y$ as a cause of $X$, while conditions two and three exclude $X$ as a cause of $Y$ (these are analogous to the sub-conditions of condition two in the definition of potential causes). Having a genuine causal relationship would require $Y \not\perp Z \| S$

# Summary