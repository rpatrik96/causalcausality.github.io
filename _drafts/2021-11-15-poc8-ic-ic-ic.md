---
title: 'Pearls of Causality #8: Inferred Causation, $IC$, and ${IC}^*$'
date: 2021-11-15
permalink: /posts/2021/11/2021-11-15-poc8-ic-ic-ic
tags:
  - causality
  - DAG
  - Latents
  - Pearl
  - Stability
  - Faithfulness
---

We will talk about IC, $IC$, and ${IC}^*$ in this post. You get the difference.

### PoC Post Series
- [PoC #7: Latents and Inferred Causation](/posts/2021/11/poc6-latents-stability-ic/)
- ➡️ [PoC #8: Inferred Causation, $IC$, and ${IC}^*$](/posts/2021/11/poc6-latents-stability/)



# Inferred Causation

It is time to see some causal discovery algorithms. There is one last thing before that though: we need to formulate when a node $C$ is the cause of node $E$. In the fully observed case, it is the existence of a directed path from $C$ to $E$. When latents are present, the we cannot use the same definition. Its extension is called the principle of **inferred causation**.


>Given distribution $\hat{P}$, node $C$ has a causal influence on node $E$ if and only if there exists a directed path from $C$ to $E$ in _every minimal latent structure consistent with_ $\hat{P}$.
>$$ 
\forall L, L' \in \mathcal{L},\  L \preceq L',  \exists \theta_G : P_{[O]}(<G, \theta_G>)=\hat{P} \\ 
\exists p = C\rightarrow \dots \rightarrow E \in L
$$

Inferred Causation is a more strict requirement than the sole existence of a $C\rightarrow \dots \rightarrow E$ path. It demands such a path in every minimal latent structure consistent with $\hat{P}$.

**Consistency is a necessary condition,** as we need to represent $\hat{P}$. As we are concerned with $\hat{P}$, we need to focus on that. Failing to find a directed path in consistent structures means that we cannot conclude a causal influence.

**Minimality is a sufficient condition,** as there is no need to restrict ourselves to minimal structures. We even get new information about those non-minimal structures if we investigate them. For they have a minimal counterpart, deciding whether there is a directed path in a non-minimal structure (which there is, as a non-minimal graph has at least the same edges to be able to express at least the same distributions) will not affect our conclusion about whether $C$ influences $E$.


# The Inductive Causation $(IC)$ algorithm

After having dived into the intricate details of causal models and latent structures, we can analyze the first algorithm for causal discovery.

The Inductive Causation $(IC)$ algorithm tackles causal discovery without latent variables. Although **when assuming stability, there will be a unique minimal causal structure, this only holds up to Markov equivalence**.

This means that IC cannot identify the ground truth graph, it will only output a pattern.

> A **pattern** is a graph with both directed and undirected edges. In our context, it is used to express Markov equivalence classes.

A separating set [$]S_{ab}[/$] is a subset of variables [$]V[/$] in DAG [$]G : a\perp b | S_{ab}.[/$]

 It is minimal, if no vertex can be removed from [$]S_{ab}[/$] so that [$]a\perp b | S_{ab}[/$] still holds.

Input: $\hat{P}$, a stable distribution on a set $V$ of variables.

Output: a pattern $H(\hat{P})$ compatible with $\hat{P}$.

For each pair of variables $a$ and $b$ in $V$,

  1. search for a set $S_{ab} : a \perp_{\hat{P}} b | S_{ab} $. Construct an undirected graph $G$ such that $a$ and $b$ are connected with an edge if and only if no set $S_{ab}$ can be found.
  2. For each pair of nonadjacent variables $a$ and $b$ with a common neighbor $c$, check if $c \in S_{ab}$.
      1. If it is, then continue.
      2. If it is not , then $a\rightarrow c \leftarrow b$ is a pattern.
  3. In the resulting PDAG, orient as many of the undirected edges as possible subject to two conditions:   the orientation should not create a new v-structure; and the orientation should not create a directed cycle.

The four rules
1.  R1 : Orient $b - c$ into $b \rightarrow  c$ whenever there is an arrow $a \rightarrow  b$ such that $a$ and $c$ are nonadjacent.
2. R2: Orient $a - b$ into $a \rightarrow  b$ whenever there is chain $a \rightarrow  c \rightarrow  b$.
3. R3 : Orient $a - b$ into $a \rightarrow  b$ whenever there are two chains $a - c \rightarrow  b$ and
$a - d \rightarrow  b $such that $c$ and $d$ are nonadjacent.
4. R4: Orient $a - b$ into $a \rightarrow  b$ whenever there are two chains $a - c \rightarrow  d$ and
$c \rightarrow  d \rightarrow  b $such that $c$ and $b$ are nonadjacent.


# The $IC^*$ algorithm

Identifying the separation sets and orienting the edges of v-structures is the same, the difference is that IC* does not orient edges but adds arrowheads.

The output of IC* is a marked pattern.

Two rules are used for this:

For each pair of nonadjacent nodes $a$ and $b$ with a common neighbor $c$:

1. if the link between $a$  and $c$ has an arrowhead into $c$ and if the link between $c$ and $b$ has no arrowhead into $c$, then add an arrowhead on the link between $c$ and $b$ pointing at $b$ and mark that link to obtain $c \rightarrow^{*} b$.
2. If $a$ and $b$ are adjacent and there is a directed path (composed strictly of marked links) from $a$  to $b$ (as in Figure 2.2), then add an arrowhead pointing toward $b$ on the link between $a$  and $b$.


Edge types
1. $a\rightarrow^{*} b$ : directed path
2. $a\rightarrow b$ : directed path or $a \leftarrow L \rightarrow b$
3. $a \longleftrightarrow b$: $a \leftarrow L \rightarrow b$
4. $a-b:$ $a \leftarrow L \rightarrow b$ or $a \leftarrow  b$ or $a \rightarrow b$

# Summary

